%% ASEN 6080 HW 1 Problem 1 Script
% By: Ian Faber

%% Housekeeping
clc; clear; close all;

%% Part 1a
mu = -0.55868076447397;
J2 = 0.17838022584977;
J3 = -0.19686144647594;

Rearth = 6378; % km
Ri = Rearth;

x = -0.64901376519124;
y = 1.18116604196553;
z = -0.75845329728369;
r = sqrt(x^2 + y^2 + z^2);

Xdd = @(x,z,r) (-mu/r^2)*(1 + ((Ri/r)^2)*J2*((15/2)*(z/r)^2-(3/2)) + ((Ri/r)^3)*J3*((35/2)*(z/r)^3 - (15/2)*(z/r)))*(x/r);
Ydd = @(y,z,r) (-mu/r^2)*(1 + ((Ri/r)^2)*J2*((15/2)*(z/r)^2-(3/2)) + ((Ri/r)^3)*J3*((35/2)*(z/r)^3 - (15/2)*(z/r)))*(y/r);
Zdd = @(z,r) (-mu/r^2)*(1 + ((Ri/r)^2)*J2*((15/2)*(z/r)^2-(9/2)))*(z/r) -(mu/r^2)*((Ri/r)^3)*J3*((35/2)*(z/r)^4 - 15*(z/r)^2 + (3/2));

Xdd(x,z,r)
Ydd(y,z,r)
Zdd(z,r)

%% Part 1c
    % Provided values
r = [
        -0.64901376519124
        1.18116604196553
        -0.75845329728369
    ]; % km
v = [
        -1.10961303850152
        -0.84555124000780
        -0.57266486645795
    ]; % km/s
mu = -0.55868076447397;
J2 = 0.17838022584977;
J3 = -0.19686144647594;

Ri = 6378; % km

X = [r; v; mu; J2; J3];

A = DynamicsPartials_MuJ2J3(X, Ri)
